<!DOCTYPE html>
<html>

<head>
  <meta charset="UTF-8">
  <title>Lesson3: Water Level Sensor</title>

  <!-- Load Blockly Core & Dependencies -->
  <script src="https://unpkg.com/blockly/blockly_compressed.js"></script>
  <script src="https://unpkg.com/blockly/blocks_compressed.js"></script>
  <script src="https://unpkg.com/blockly/python_compressed.js"></script>
  <script src="https://unpkg.com/blockly/msg/en.js"></script>

  <!-- External CSS -->
  <link rel="stylesheet" href="{{ url_for('static', filename='css/scenario1/lesson3.css') }}">

</head>

<body>

  <div class="container">
    <h1>ğŸŒŠ Lesson3: Water Level Sensor</h1>
    <p class="subtitle"><strong>Pins:</strong> VCC (3.3V), GND, DATA (GPIO17)</p>

    <!-- Toolbox -->
    <xml id="toolbox" style="display: none">
      <category name="ğŸ“¦ Import Modules" colour="230">
        <block type="import_rpi_gpio"></block>
        <block type="import_time"></block>
      </category>
      <category name="âš™ï¸ GPIO Setup" colour="120">
        <block type="gpio_setmode"></block>
        <block type="setup_water_pin"></block>
        <block type="gpio_setup_input"></block>
      </category>
      <category name="ğŸ”„ Control Flow" colour="290">
        <block type="infinite_loop"></block>
      </category>
      <category name="ğŸŒŠ Water Detection" colour="180">
        <block type="water_detected_condition"></block>
        <block type="print_water_detected"></block>
        <block type="print_no_water"></block>
        <block type="delay_one_second"></block>
      </category>
    </xml>

    <!-- Blockly Workspace -->
    <div id="blocklyDiv"></div>

    <div class="button-container">
      <button onclick="generateCode()">ğŸ Generate Python Code</button>
      <button onclick="clearWorkspace()" class="clear-btn">ğŸ—‘ï¸ Clear Workspace</button>
      <button onclick="runCode()" class="run-btn">â–¶ï¸ Run </button>
    </div>

    <div class="output-container">
      <div class="output-section">
        <h3>ğŸ Generated Python Code:</h3>
        <pre id="output">Click "Generate Python Code" to see the result...</pre>
      </div>
      <div class="output-section">
        <h3><span class="status-indicator status-ready" id="statusIndicator"></span>ğŸ–¥ï¸ Simulation Output:</h3>
        <pre id="executionOutput" class="execution-output">Click "Run Simulation" to test the generated code...</pre>
      </div>
    </div>

    <button id="sendBtn" onclick="callSemarAPI('water')" class="test-btn" style="display:none;">ğŸ’§ Send Water Sensor</button>

  </div>

  <!-- External JS -->
  <script src="{{ url_for('static', filename='js/scenario1/lesson3.js') }}"></script>

</body>

</html>